import{j as n}from"./index-2131e199.js";import{r}from"./vendor-fb33f09a.js";import{u as d,b as m}from"./router-da1a9608.js";import{T as l}from"./tmdb-7d22c749.js";import"./firebase-675639f3.js";import"./swiper-4aa82847.js";import"./ui-587aa023.js";const y=()=>{const[u,t]=r.useState("Processing Authentication..."),[i]=d(),o=m();return r.useEffect(()=>{(async()=>{try{const e=i.get("request_token"),c=i.get("approved");if(console.log("Auth callback URL params:",{requestToken:e,approved:c}),e&&c==="true"){t("Creating session..."),console.log("Processing TMDB auth callback with token:",e);const s=(await l.createSession(e)).session_id;t("Getting account details...");const a=await l.getAccountDetails(s);console.log("Session created:",s,"Account:",a),localStorage.setItem("tmdb_session_id",s),localStorage.setItem("tmdb_user",JSON.stringify(a)),localStorage.setItem("tmdb_session",JSON.stringify({sessionId:s,account:a})),t("Authentication successful!"),window.opener?(window.opener.postMessage({type:"tmdb_auth_success",user:a,sessionId:s},window.location.origin),setTimeout(()=>window.close(),1e3)):setTimeout(()=>{o("/")},1e3)}else console.error("Auth callback failed: Invalid token or not approved"),t("Authentication failed. Please try again."),setTimeout(()=>{window.opener?window.close():o("/")},2e3)}catch(e){console.error("Auth callback error:",e.message),t("Authentication failed. Please try again."),setTimeout(()=>{window.opener?window.close():o("/")},2e3)}})()},[i,o]),n.jsx("div",{className:"auth-callback",style:{backgroundColor:"#141414",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"white",textAlign:"center"},children:n.jsxs("div",{children:[n.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:u}),n.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"48px",color:"#e50914"}})]})})};export{y as default};
